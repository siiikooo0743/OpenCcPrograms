multishell.setTitle(multishell.getCurrent(), "MasterLoop") 

function getItem(name, amount)
  print("Get Item!")
  print("Name:" .. name)
  print("Amount:" .. name)
end

function processTasks()
  while true do
    l = fs.list("ItemSystem/tasks")
    for _, file in ipairs(l) do 
      print("Looking for:" .. file)
      f = fs.open("ItemSystem/tasks/" .. file, "r")
      name = f.readLine()
      amount = f.readLine()
    end
    coroutine.yield()
  end
end

function listen()
  while true do
    id, msg = rednet.receive()
    print("Message received!")
    print("Id:" .. id)
    print("Message:" .. msg)
    coroutine.yield()
  end
end

rednet.open("right")

while true do
  coroutine.create(listen())
  coroutine.create(processTaks())

end

